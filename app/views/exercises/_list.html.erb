<table class="table table-striped tablesorter">
	<thead>
		<tr>
			<th>Nombre</th>
			<th>Area</th>
			<th class="text_center">Descripción</th>
			<th class="text_center">Objetivo</th>
			<% if params[:group_id] %>
				<th class="text_center">Seleccionar</th>
			<% elsif params[:program_id] %>
				<th class="text_center">Seleccionar</th>
			<% else %>
				<th class="text_center">Rango (Semanas)</th>
			<% end %>
			<td class="text_center">
				<b>Leer más</b>
			</td>
		</tr>
	</thead>
	<tbody>
		<% @exercises.each_with_index do |exercise, index| %>
		<tr>
			<td>
				<%= link_factory( :_path => exercise_path(exercise), :_text => exercise.name ) %>
			</td>
			<td>
				<% if exercise.areas.count==1 %>
					<%= exercise.areas.first.name %>
				<% else %>
					<% exercise.areas.each do |a| %>
						<% areasplit = a.name.split(' ') %>
						<span data-toggle="tooltip" data-placement="left" title="<%= a.name %>" class="tip" data-original-title="<%= a.name %>">
						<% areasplit.each do |word| %><%= word.slice(0..0) %><% end %>
						</span>
					<% end %>
				<% end %>
			</td>
			<td class="text_center">
			<button type="button" class="btn btn-primary pops btn-xs" data-container="body" data-toggle="popover" data-placement="left" data-content="<%= exercise.description %>">Descripción</button></td>
			<td class="text_center">
				<button type="button" class="btn btn-primary pops btn-xs" data-container="body" data-toggle="popover" data-placement="left" data-content="<%= exercise.objective %>">Objetivo</button>
			</td>
			<td class="text_center">
				<% if params[:group_id] %>
					<a href=<%= "/exercises/status/#{exercise.id}?lecture_id=#{@lecture.id}" %> data-remote="true" id="exercise_<%= exercise.id %>">
						<% if exercise.lectures.include?(@lecture) %>
							<button type="button" class="btn status_button btn-danger btn-xs">DESAGREGAR</button>
						<% else %>
							<button type="button" class="btn status_button btn-success btn-xs">AGREGAR</button>
						<% end %>
					</a>
				<% elsif params[:program_id] %>
					<%= link_to program_program_relations_path(@program, :lecture_id => @lecture, :exercise_id => exercise.id), :remote => true, :id => "exercise_#{exercise.id}", :method => 'post', :id => "program_relation_#{index}" do %>
						<% @program_relation = @program.program_relations.where( :exercise_id => exercise.id, :lecture => @lecture ).first %>
							<% if @program_relation %>
								<button type="button" class="btn status_button btn-danger btn-xs">DESAGREGAR</button>
							<% else %>
								<button type="button" class="btn status_button btn-success btn-xs">AGREGAR</button>
							<% end %>
					<% end %>
				<% else %>
					<%= "#{exercise.min_age} - #{exercise.max_age} " %>
				<% end %>
			</td>
			<td class="text_center">
				<a href="#" data-toggle="modal" data-target="#ex_<%= index %>" title="Leer más">
					<span class="glyphicon-class glyphicon glyphicon-eye-open" ></span>
				</a>
			</td>
		</tr>
		<div class="modal fade" id="ex_<%= index %>" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
				<div class="modal-dialog">
					<div class="modal-content">
						<div class="modal-header">
							<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
							<h4 class="modal-title" id="myModalLabel">
								<%= link_factory( :_path => exercise_path(exercise), :_text =>exercise.name ) %>
							</h4>
						</div>
						<div class="modal-body">
							<p><strong>Rango:</strong> <%= "#{exercise.min_age} - #{exercise.max_age} semanas" %></p>
							<p><strong>Descripción:</strong> <%= exercise.description %></p>
							<p><strong>Objetivo:</strong> <%= exercise.objective %></p>
							<p><strong>Material:</strong> <%= exercise.material %></p>
							<p><strong>Música:</strong> <%= exercise.music %></p>
						</div>
						<div class="modal-footer">
							<button type="button" class="btn btn-danger" data-dismiss="modal">Cerrar</button>
						</div>
					</div>
				</div>
			</div>
		<% end %>
	</tbody>
</table>